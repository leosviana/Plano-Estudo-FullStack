<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Promises e async</title>
</head>
<body>
    <h2>APERTE A TECLA F12 E VEJA O RESULTADO DO JAVASCRIPT</h2>
    <script>
        //Promise - É uma promessa da vida real. Algo que vai acontecer no futuro (mas ainda não aconteceu)
        //Ele tem 3 estados:
        // - pending(pendente)
        // - fulfilled(cumprida -> sucesso)
        // - rejected(rejeitada -> erro)

        //--------------------------------------------
        //Usando fetch(), .then() e .catch()
        //Fetch é usado para buscar dados da API(servidor). Ele retorna uma Promise.
        //Estilo em cadeia
        fetch("https://jsonplaceholder.typicode.com/posts/1") //Simula uma API
            .then(data => {
                console.log("Dados recebidos: ", data); //Sucesso                
            })
            .catch(error => {
                console.log("Ocorreu um erro: ", error); //Erro
            });

        //--------------------------------------------
        //Usando async/await (Jeito mais moderno)
        //Estilo "passo a passo", mais parecido com código sincrono(mais fácil de ler)
        async function buscarPost(){
            try{
                const response = await fetch("https://jsonplaceholder.typicode.com/posts/1");
                const data = await response.json();
                console.log("Dados recebidos: ", data);
            }catch(error){
                console.error("Erro de requisição: ", error);
            }
        }
        buscarPost();

        //--------------------------------------------
        //Exemplo prático em um marketplace
        //Imagine que vou buscar um produto em uma API de marketplace
        async function carregarProdutos(){
            try{
                const response = await fetch("https://jsonplaceholder.typicode.com/posts/1");
                const produtos = await response.json();
                //Simula a renderização:
                console.log("Lista de produtos:");
                produtos.slice(0, 5).forEach(produto => {
                    console.log(`Produto ${produto.title}`);
                });
            }catch(error){
                console.log("Erro ao carregar produto: ", error);
            }
        }
        carregarProdutos();
        
        
    </script>
    
</body>
</html>